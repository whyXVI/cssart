<template>
  <div class="squiggles-wrapper">
    <div class="container">
    <svg
      ref="svgContainer"
      width="80%"
      height="80%"
      id="Layer_1"
      data-name="Layer 1"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="-5 -5 600.95 200"
    >
      <path
        ref="pathElement"
        class="cls-1"
        d="M533.42,61.71c-44.03-22.74-94.83-27.9-144.3-30.76-64.01-3.7-128.21-4.24-192.27-1.61-39.66,1.63-79.33,4.47-118.51,10.81-18.39,2.97-37,6.84-53.23,15.98-6.01,3.39-11.89,7.77-14.67,14.09-5.71,12.94,3.64,27.48,13.86,37.25,30,28.69,70.52,43.44,110.52,54.55,112.86,31.37,232.03,39.81,348.19,24.68,25.99-3.39,52.13-8.03,76.08-18.67,9.89-4.4,19.82-10.26,25.04-19.74,6.45-11.71,4.17-26.67-2.38-38.33-10.8-19.24-31.16-30.87-51-40.53C399.22,5.34,247.35-13.36,102.78,9.12c-20.88,3.25-41.64,7.33-62.01,12.93-14.13,3.88-29.17,9.33-37.04,21.68-7.87,12.35-2.92,33.06,11.59,35.09"
      />
    </svg>
    <div ref="penElement" class="pen">
      <svg
        version="1.1"
        id="Layer_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        viewBox="0 0 496 496"
        xml:space="preserve"
        fill="#000000"
      >
        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
        <g
          id="SVGRepo_tracerCarrier"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></g>
        <g id="SVGRepo_iconCarrier">
          <rect
            x="239.283"
            y="39.134"
            transform="matrix(0.7071 0.7071 -0.7071 0.7071 211.716 -190.0609)"
            style="fill: #4bb19b"
            width="191.998"
            height="242.798"
          ></rect>
          <rect
            x="183.083"
            y="113.86"
            transform="matrix(0.7071 -0.7071 0.7071 0.7071 -2.5027 253.2773)"
            style="fill: #61c2ab"
            width="242.798"
            height="31.6"
          ></rect>
          <path
            style="fill: #e8e3e3"
            d="M74.4,451.2l8,8L314,316.8L297.6,300L108.4,416.4c-0.4,0-0.8,0.4-1.2,0.4c-0.8,0-1.2-0.4-1.6-0.8 c-0.4-0.8-0.4-2,0.8-2.8l188.4-116L179.2,181.6L36.8,413.2L74.4,451.2L74.4,451.2L74.4,451.2z"
          ></path>
          <g>
            <rect
              x="22.699"
              y="432.922"
              transform="matrix(0.707 0.7072 -0.7072 0.707 333.6581 103.6817)"
              style="fill: #aeb1b4"
              width="38"
              height="43.2"
            ></rect>
            <path
              style="fill: #aeb1b4"
              d="M6,470.8c0,5.2,2,10,5.6,13.6S20,490,25.2,490c4.4,0,8.4-1.6,12-4.4l-26.4-26.4 C7.6,462.4,6,466.4,6,470.8z"
            ></path>
          </g>
          <g>
            <polygon
              style="fill: #cccccc"
              points="70.4,452.4 71.6,451.2 51.6,431.2 44.8,424.4 43.6,425.6 "
            ></polygon>
            <path
              style="fill: #cccccc"
              d="M71.6,451.2l-20-20L71.6,451.2z"
            ></path>
          </g>
          <path
            d="M82.4,465.6c-1.2,0-2-0.4-2.8-1.2l-48.4-48c-1.2-1.2-1.6-3.2-0.4-4.8l144.8-235.2c0-0.4,0.4-0.4,0.4-0.8L350.4,1.2 c0.8-0.8,1.6-1.2,2.8-1.2l0,0c1.2,0,2,0.4,2.8,1.2L494.4,140c1.6,1.6,1.6,4,0,5.6L320,320c-0.4,0.4-0.4,0.4-0.8,0.4L84.4,464.8 C84,465.6,83.2,465.6,82.4,465.6z M39.2,412.8l44,43.6L314.8,314L486,142.8L353.2,9.6L182,180.8L39.2,412.8z"
          ></path>
          <path
            d="M25.2,496c-6.4,0-12.8-2.4-17.6-7.2c-9.6-9.6-9.6-25.6,0-35.2l33.2-33.2c1.6-1.6,4-1.6,5.6,0s1.6,4,0,5.6l-33.2,33.2 c-6.4,6.4-6.4,17.6,0,24s17.2,6.4,24,0L70.4,450c1.6-1.6,4-1.6,5.6,0s1.6,4,0,5.6l-33.2,33.2C38,493.6,31.6,496,25.2,496z"
          ></path>
          <path
            d="M317.2,321.2c-1.2,0-2-0.4-2.8-1.2L176,181.2c-1.6-1.6-1.6-4,0-5.6s4-1.6,5.6,0L320,314.4c1.6,1.6,1.6,4,0,5.6 C319.2,320.8,318.4,321.2,317.2,321.2z"
          ></path>
          <path
            d="M107.2,418.8c-1.2,0-2.8-0.8-3.6-2c-1.2-2-0.4-4.4,1.2-5.6l190.4-116.8c2-1.2,4.4-0.4,5.6,1.2c1.2,2,0.4,4.4-1.2,5.6 L109.2,418C108.8,418.8,108,418.8,107.2,418.8z"
          ></path>
          <path
            d="M40,489.6c-1.2,0-2-0.4-2.8-1.2L7.6,459.2c-1.6-1.6-1.6-4,0-5.6s4-1.6,5.6,0l29.6,29.2c1.6,1.6,1.6,4,0,5.6 C42,489.2,41.2,489.6,40,489.6z"
          ></path>
        </g>
      </svg>
    </div>
    <p class="text1">Squig<span>gl</span>es</p>
    <p class="text2">Squig<span>gl</span>es</p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, onUnmounted } from 'vue'
import { gsap, DrawSVGPlugin,MotionPathPlugin  } from 'gsap/all'

// Template refs
const pathElement = ref<SVGPathElement>()
const penElement = ref<HTMLDivElement>()
const svgContainer = ref<SVGElement>()

// Animation timeline for cleanup
let timeline: gsap.core.Timeline

onMounted(() => {
  // Register GSAP plugins
  gsap.registerPlugin(DrawSVGPlugin, MotionPathPlugin)
  
  // Create timeline for better control
  timeline = gsap.timeline()
  
  // Path drawing animation
  timeline.from(pathElement.value, { 
    duration: 3, 
    drawSVG: 0, 
    ease: 'expoScale(0.5,7,none)' 
  })
  
  // Pen motion along path
  timeline.to(penElement.value, {
    motionPath: {
      path: pathElement.value,
      align: pathElement.value,
      alignOrigin: [0.27, 0.73],
    },
    ease: "expoScale(0.5,7,none)",
    duration: 3,
  }, 0) // Start at the same time as path drawing
})

onUnmounted(() => {
  // Cleanup animations
  if (timeline) {
    timeline.kill()
  }
})

// Optional: Add restart animation method
const restartAnimation = () => {
  if (timeline) {
    timeline.restart()
  }
}

// Export for potential parent component control
defineExpose({
  restartAnimation
})
</script>

<style scoped>
@import url('https://fonts.googleapis.com/css2?family=Bad+Script&display=swap');

.squiggles-wrapper {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100%;
  background-color: #242424;
  font-family: 'Bad Script', cursive;
  color: rgba(255, 255, 255, 1);
}

.container {
  width: 50%;
  height: 50%;
  position: relative;
}

.text1,
.text2 {
  position: absolute;
  margin: 0;
  text-align: center;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  font-size: 9vw;
}

.text1 {
  z-index: 2;
}

.text2 {
  z-index: 0;
}

.text1 span {
  opacity: 0;
  position: relative;
}

.text2 span {
  opacity: 1;
  position: relative;
}

.pen {
  width: 9vw;
  height: 9vw;
  position: relative;
  z-index: 1;
}

svg {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 1;
}

/* SVG path styles */
.cls-1 {
  fill: none;
  stroke: #ff5ca5;
  stroke-miterlimit: 10;
  stroke-width: 4;
}


</style>